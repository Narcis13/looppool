---
phase: 04-workflow-integration
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - get-shit-done/workflows/execute-phase.md
  - commands/gsd/execute-phase.md
autonomous: true

must_haves:
  truths:
    - "Execute-phase orchestrator handles failure recovery decisions autonomously when enabled"
    - "Checkpoint handling respects AUTONOMOUS flag via referenced policies"
    - "Interactive paths remain unchanged when autonomous disabled"
  artifacts:
    - path: "get-shit-done/workflows/execute-phase.md"
      provides: "Autonomous flag reading, failure recovery autonomous handling"
      contains: "AUTONOMOUS="
    - path: "commands/gsd/execute-phase.md"
      provides: "Autonomous flag reading propagated to workflow"
      contains: "AUTONOMOUS="
  key_links:
    - from: "commands/gsd/execute-phase.md"
      to: "get-shit-done/workflows/execute-phase.md"
      via: "execution_context reference"
      pattern: "@~/.claude/get-shit-done/workflows/execute-phase.md"
---

<objective>
Add autonomous handling to execute-phase workflow for orchestrator-level decisions (failure recovery, checkpoint routing).

Purpose: FLOW-03 requires execute-phase to handle all checkpoints autonomously when autonomous enabled. The checkpoint handling itself delegates to POLICY-06/07 (already integrated in execute-plan.md in Phase 3), but the orchestrator needs to handle failure recovery decisions autonomously.

Output: execute-phase.md workflow and command with autonomous flag reading and failure recovery autonomy.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
@~/.claude/get-shit-done/references/autonomous.md
@~/.claude/get-shit-done/references/decision-policies.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

Phase 3 summaries (patterns already established):
- 03-02: Autonomous wrapper pattern, policy trace format
- 03-03: Interactive paths preserved, POLICY-XX references in traces
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add autonomous flag reading to execute-phase workflow</name>
  <files>get-shit-done/workflows/execute-phase.md</files>
  <action>
Add autonomous flag reading step after resolve_model_profile, before load_project_state.

Insert new step `check_autonomous_mode` with priority="first":

```markdown
<step name="check_autonomous_mode" priority="first">
Read autonomous mode setting:

```bash
AUTONOMOUS=$(cat .planning/config.json 2>/dev/null | grep -o '"autonomous"[[:space:]]*:[[:space:]]*[^,}]*' | grep -o 'true\|false' || echo "false")
```

Store for use in decision points below. Checkpoint handling via execute-plan.md already references POLICY-06/07.
</step>
```

Then modify `execute_waves` step point 4 (failure handling) to add autonomous handling:

In the "Handle failures" section, wrap the existing AskUserQuestion with AUTONOMOUS flag check:

```markdown
4. **Handle failures:**

   If any agent in wave fails:
   - Report which plan failed and why

   **If AUTONOMOUS=true:**

   Apply default: Continue with remaining waves (recoverable failure) or stop (systemic failure).

   Recoverable: Single plan failure, others can proceed.
   Systemic: Git issues, permissions, all agents failed.

   ```
   Auto-decided: {continue|stop} -- {reason} [autonomous-defaults.md]
   ```

   **If AUTONOMOUS=false:**

   - Ask user: "Continue with remaining waves?" or "Stop execution?"

   - If continue: proceed to next wave (dependent plans may also fail)
   - If stop: exit with partial completion report
```

Also modify `verify_phase_goal` step to add autonomous handling for human_needed and gaps_found routing:

In the human_needed section:
```markdown
**If human_needed:**

**If AUTONOMOUS=true:**

Human verification items noted but cannot be auto-verified. Log and proceed.

```
Auto-decided: proceed with noted items -- Human verification requires visual/interactive testing [autonomous-defaults.md]
```

Continue to update_roadmap. Items logged in VERIFICATION.md for manual review.

**If AUTONOMOUS=false:**

```markdown
## ✓ Phase {X}: {Name} — Human Verification Required
...
```
```

The gaps_found handling remains interactive (requires user decision on gap closure planning).
  </action>
  <verify>
grep "AUTONOMOUS=" get-shit-done/workflows/execute-phase.md
grep "Auto-decided:" get-shit-done/workflows/execute-phase.md
  </verify>
  <done>
execute-phase.md workflow has AUTONOMOUS flag reading and autonomous handling for failure recovery and human_needed verification routing.
  </done>
</task>

<task type="auto">
  <name>Task 2: Update execute-phase command with autonomous reference</name>
  <files>commands/gsd/execute-phase.md</files>
  <action>
Add decision-policies.md and autonomous.md to execution_context section:

```markdown
<execution_context>
@~/.claude/get-shit-done/references/ui-brand.md
@~/.claude/get-shit-done/workflows/execute-phase.md
@~/.claude/get-shit-done/references/autonomous.md
@~/.claude/get-shit-done/references/decision-policies.md
</execution_context>
```

This ensures the command loads the autonomous patterns when executing.

No changes needed to the process section - it delegates to the workflow which now has autonomous handling.
  </action>
  <verify>
grep "autonomous.md" commands/gsd/execute-phase.md
grep "decision-policies.md" commands/gsd/execute-phase.md
  </verify>
  <done>
execute-phase.md command references autonomous.md and decision-policies.md in execution_context.
  </done>
</task>

</tasks>

<verification>
1. grep confirms AUTONOMOUS flag reading exists in workflow
2. grep confirms Auto-decided trace outputs exist
3. Interactive paths (AUTONOMOUS=false) remain unchanged
4. File structure follows established patterns from Phase 3
</verification>

<success_criteria>
- [ ] execute-phase workflow reads AUTONOMOUS flag once at start
- [ ] Failure recovery decision has autonomous handling with trace
- [ ] human_needed verification has autonomous handling with trace
- [ ] Interactive paths preserved exactly as before
- [ ] Command references autonomous.md and decision-policies.md
</success_criteria>

<output>
After completion, create `.planning/phases/04-workflow-integration/04-01-SUMMARY.md`
</output>
