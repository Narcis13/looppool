---
phase: 04-workflow-integration
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - commands/gsd/discuss-phase.md
  - get-shit-done/workflows/discuss-phase.md
autonomous: true

must_haves:
  truths:
    - "discuss-phase SKIPS entirely in autonomous mode (exits early with trace)"
    - "When autonomous disabled, discussion flow works exactly as before"
    - "User running discuss-phase explicitly still gets interaction if autonomous disabled"
  artifacts:
    - path: "commands/gsd/discuss-phase.md"
      provides: "Autonomous flag reading and early exit"
      contains: "AUTONOMOUS="
    - path: "get-shit-done/workflows/discuss-phase.md"
      provides: "Autonomous early exit step"
      contains: "Auto-decided: skip discussion"
  key_links:
    - from: "commands/gsd/discuss-phase.md"
      to: "get-shit-done/workflows/discuss-phase.md"
      via: "execution_context reference"
      pattern: "@~/.claude/get-shit-done/workflows/discuss-phase.md"
---

<objective>
Implement autonomous handling for discuss-phase that SKIPS the workflow entirely when autonomous mode enabled.

Purpose: Discussion is inherently about gathering user input. In autonomous mode, skipping discussion and proceeding directly to planning is the correct behavior. This is different from other workflows where autonomous means "auto-decide" - here it means "skip entirely".

Output: discuss-phase command and workflow that exit early with trace when autonomous enabled.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
@~/.claude/get-shit-done/references/autonomous.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

Research finding (04-RESEARCH.md):
"In autonomous mode, discuss-phase should SKIP entirely (not auto-answer). User ran it explicitly = wants discussion."

The key insight: discuss-phase gathers user VISION, not technical decisions. Autonomous mode skips discussion, letting the planner use documented defaults from REQUIREMENTS.md, RESEARCH.md.
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add autonomous early exit to discuss-phase workflow</name>
  <files>get-shit-done/workflows/discuss-phase.md</files>
  <action>
Add new step `check_autonomous_mode` with priority="first" BEFORE the existing validate_phase step.

Insert at the beginning of the `<process>` section:

```markdown
<step name="check_autonomous_mode" priority="first">
Read autonomous mode setting:

```bash
AUTONOMOUS=$(cat .planning/config.json 2>/dev/null | grep -o '"autonomous"[[:space:]]*:[[:space:]]*[^,}]*' | grep -o 'true\|false' || echo "false")
```

**If AUTONOMOUS=true:**

Discussion is inherently interactive - it gathers user vision and preferences. In autonomous mode, skip discussion and let planner use documented defaults.

```
Auto-decided: skip discussion -- Autonomous mode enabled, discussion requires human input [autonomous-defaults.md]
```

Output to user:
```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
 GSD ► DISCUSS SKIPPED (Autonomous Mode)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

Discussion requires human input. In autonomous mode, proceed directly to planning.

The planner will use:
- REQUIREMENTS.md for feature scope
- RESEARCH.md for implementation patterns (if exists)
- Documented defaults for any ambiguities

───────────────────────────────────────────────────────────────

## ▶ Next Up

/gsd:plan-phase {phase}

<sub>/clear first → fresh context window</sub>

───────────────────────────────────────────────────────────────
```

Exit workflow.

**If AUTONOMOUS=false:**

Continue to validate_phase step.
</step>
```

Keep all existing steps unchanged - they only execute when AUTONOMOUS=false.
  </action>
  <verify>
grep "AUTONOMOUS=" get-shit-done/workflows/discuss-phase.md
grep "skip discussion" get-shit-done/workflows/discuss-phase.md
  </verify>
  <done>
discuss-phase workflow has autonomous check that skips discussion entirely with trace output.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add autonomous reference to discuss-phase command</name>
  <files>commands/gsd/discuss-phase.md</files>
  <action>
Add autonomous.md reference to execution_context section.

Update execution_context from:
```markdown
<execution_context>
@~/.claude/get-shit-done/workflows/discuss-phase.md
@~/.claude/get-shit-done/templates/context.md
</execution_context>
```

To:
```markdown
<execution_context>
@~/.claude/get-shit-done/workflows/discuss-phase.md
@~/.claude/get-shit-done/templates/context.md
@~/.claude/get-shit-done/references/autonomous.md
</execution_context>
```

This ensures the command has access to autonomous patterns.
  </action>
  <verify>
grep "autonomous.md" commands/gsd/discuss-phase.md
  </verify>
  <done>
discuss-phase command references autonomous.md in execution_context.
  </done>
</task>

</tasks>

<verification>
1. grep confirms AUTONOMOUS flag reading exists
2. grep confirms "skip discussion" trace exists
3. Interactive flow (validate_phase, analyze_phase, etc.) unchanged
4. Early exit message guides user to /gsd:plan-phase
</verification>

<success_criteria>
- [ ] Workflow reads AUTONOMOUS flag first
- [ ] When autonomous=true, workflow exits early with trace and guidance
- [ ] When autonomous=false, existing interactive flow unchanged
- [ ] Exit message directs user to /gsd:plan-phase
- [ ] Command references autonomous.md
</success_criteria>

<output>
After completion, create `.planning/phases/04-workflow-integration/04-02-SUMMARY.md`
</output>
